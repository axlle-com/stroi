function ImageBox(a){this.search_box=a,this.image_big_selector=".product-top",this.selector_lightbox=0,this.data_tumb="data-tumb",this.data_title="data-title",this.data_big="data-big",this.images_tumb=[],this.image_big=[],this.image=[],this.slide_selector=[],this.lightbox_selector=[],this.box_image=[],this.box_overlay=[],this.time=500}function gallery_box(){function c(){ImageBox.apply(this,arguments)}var a=document.querySelectorAll(".popup-gallery");if(a.length>0){var b={};c.prototype=Object.create(ImageBox.prototype),c.prototype.constructor=c;for(var d=0,e=a.length;d<e;d++)b["showbox_"+d]=new ImageBox(a[d]),b["showbox_"+d].start()}}ImageBox.prototype.start=function(){this.box_image=this.search_box.querySelector(""+this.image_big_selector),this.box_image&&(this.selector_lightbox=1),this.box_overlay=this.search_box.querySelector(".box_overlay"),this.tumb_collection(),this.image_box_fil(),this.block_height(),this.links_collection()},ImageBox.prototype.image_big_fill=function(){this.selector_lightbox&&(this.image_big=this.box_image.querySelectorAll("["+this.data_big+"]"))},ImageBox.prototype.image_box_fil=function(){if(this.image_big_fill(),this.selector_lightbox)for(var b=0,c=this.image_big.length;b<c;b++)this.image_big[b].setAttribute(this.data_big,b),this.image[b]=this.image_big[b].querySelector("img"),this.image[b].getAttribute("src")!=this.images_tumb[b].getAttribute(this.data_tumb)&&this.image[b].setAttribute("src",this.images_tumb[b].getAttribute(this.data_tumb));else console.log("%c Error #1-no product ","background-color: #49137e; color: #fff;")},ImageBox.prototype.tumb_collection=function(){return this.images_tumb=this.search_box.querySelectorAll("["+this.data_tumb+"]")},ImageBox.prototype.slide_selector_collection=function(){this.box_image&&(this.slide_selector=this.box_image.querySelectorAll("[data-box-slide]"))},ImageBox.prototype.block_height=function(){if(this.box_image){var a=getComputedStyle(this.box_image),b=parseInt(a.width);b=Math.round(b/1.5*100)/100,this.box_image.style.height=b+"px";var c=getComputedStyle(this.images_tumb[0]),d=parseInt(c.width);for(d=Math.round(d/1.5*100)/100,i=0,len=this.images_tumb.length;i<len;i++)this.images_tumb[i].style.height=d+"px"}},ImageBox.prototype.links_collection=function(){function d(){c||(c=!0,b.show_slider(b,this),setTimeout(function(){c=!1},b.time))}function e(){if(!c){c=!0;for(var a,d=0,e=b.images_tumb.length;d<e;d++)b.images_tumb[d]==this&&(a=d);b.box_image&&b.show_big_image(b,b.box_image,this,a),b.box_overlay&&b.show_big_image(b,b.box_overlay,this,a),setTimeout(function(){c=!1},b.time)}}this.slide_selector_collection();var b=this,c=!1;if(this.selector_lightbox)for(var f=0,g=this.images_tumb.length;f<g;f++)this.images_tumb[f].addEventListener("click",e);else for(var f=0,g=this.images_tumb.length;f<g;f++)this.images_tumb[f].addEventListener("click",function(a){a.preventDefault()}),this.images_tumb[f].addEventListener("click",e),this.images_tumb[f].addEventListener("click",this.show_overlay.bind(this,f));for(var h=0,i=this.slide_selector.length;h<i;h++)this.slide_selector[h].addEventListener("click",d);this.images_tumb[0]&&this.images_tumb[0].classList.add("tumb-active"),window.addEventListener("resize",this.block_height.bind(this))},ImageBox.prototype.show_box_image=function(a,b){this.image_big=this.search_box.querySelectorAll("["+this.data_big+"]"),this.image_big[0].setAttribute("src",a.getAttribute(this.data_tumb)),this.image_big[0].setAttribute(""+this.data_big,b);for(var c=0,d=this.images_tumb.length;c<d;c++)this.images_tumb[c]!=a&&this.images_tumb[c].classList.remove("tumb-active");a.classList.add("tumb-active")},ImageBox.prototype.show_slider=function(a,b){this.image_big_fill();var c="";b.hasAttribute("data-box-slide")?c=b.getAttribute("data-box-slide"):b.hasAttribute("data-lightbox-slide")&&(c=b.getAttribute("data-lightbox-slide"));var d;d=this.selector_lightbox?this.box_image.querySelector(".image-active"):this.box_overlay.querySelector(".image-active");var e=d.getAttribute(""+this.data_big);"prev"==c?(0==e?e=this.images_tumb.length-1:e--,this.selector_lightbox&&this.show_big_image(this,this.box_image,this.images_tumb[e],e,c),this.box_overlay?this.show_big_image(this,this.box_overlay,this.images_tumb[e],e,c):console.log("%c Error #4.0-not box-overlay ","background-color: #49137e; color: #fff;")):"next"==c?(e==this.images_tumb.length-1?e=0:e++,this.selector_lightbox&&this.show_big_image(this,this.box_image,this.images_tumb[e],e,c),this.box_overlay?this.show_big_image(this,this.box_overlay,this.images_tumb[e],e,c):console.log("%c Error #4.1-not box-overlay ","background-color: #49137e; color: #fff;")):"loupe"==c?this.show_overlay(e):"close"==c?this.close_overlay():console.log("%c  \u0415\u0441\u043b\u0438 \u0432\u044b \u0443\u0432\u0438\u0434\u0435\u043b\u0438 \u043e\u0448\u0438\u0431\u043a\u0443 \u043d\u0430\u043f\u0438\u0448\u0438\u0442\u0435,\u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043d\u0430 E-mail: axlle@mail.ru ! ","background-color: #49137e; color: #fff;")},ImageBox.prototype.show_big_image=function(a,b,c,d,e){if(b){var f=b.querySelector("["+this.data_big+'="'+d+'"]'),g=b.querySelector(".image-active");if(f)this.add_class(g,f,e);else{var h=document.createElement("div");h.setAttribute(this.data_big,d),h.classList.add("box-image");var i=document.createElement("img");i.setAttribute("src",c.getAttribute(this.data_tumb)),i.setAttribute("alt",c.getAttribute(this.data_title)),i.classList.add("img-responsive"),h.appendChild(i);for(var j=0,k=this.images_tumb.length;j<k;j++){var l=b.querySelector("["+this.data_big+'="'+(d-j)+'"]'),m=b.querySelector("["+this.data_big+'="'+(d+j)+'"]');if(l){l.parentNode.insertBefore(h,l.nextSibling),this.add_class(g,h,e);break}if(m){m.parentNode.insertBefore(h,m),this.add_class(g,h,e);break}}}for(var n=0,o=this.images_tumb.length;n<o;n++)this.images_tumb[n]!=c&&this.images_tumb[n].classList.remove("tumb-active");c.classList.add("tumb-active")}else console.log("%c Error #5 ","background-color: #49137e; color: #fff;")},ImageBox.prototype.add_class=function(a,b,c){var d=Number(a.getAttribute(this.data_big)),e=Number(b.getAttribute(this.data_big)),f=this;c?"next"==c?(b.classList.add("next"),setTimeout(function(){a.classList.add("left"),b.classList.add("left")},4),setTimeout(function(){a.className="box-image",b.className="box-image image-active"},f.time)):"prev"==c&&(b.classList.add("prev"),setTimeout(function(){a.classList.add("right"),b.classList.add("right")},4),setTimeout(function(){a.className="box-image",b.className="box-image image-active"},f.time)):d<e?(b.classList.add("next"),setTimeout(function(){a.classList.add("left"),b.classList.add("left")},4),setTimeout(function(){a.className="box-image",b.className="box-image image-active"},f.time)):d>e&&(b.classList.add("prev"),setTimeout(function(){a.classList.add("right"),b.classList.add("right")},4),setTimeout(function(){a.className="box-image",b.className="box-image image-active"},f.time))},ImageBox.prototype.show_overlay=function(a){if(this.box_overlay)this.box_overlay.classList.add("active");else{this.box_overlay=document.createElement("div"),this.box_overlay.setAttribute("class","box_overlay"),this.search_box.appendChild(this.box_overlay);var b=document.createElement("div");b.setAttribute("class","box_lightbox"),this.box_overlay.appendChild(b);var c=document.createElement("div");c.setAttribute("data-big",a),c.classList.add("box-image"),c.classList.add("image-active"),b.appendChild(c);var d=document.createElement("img");d.setAttribute("class","img-responsive"),d.setAttribute("src",this.images_tumb[a].getAttribute(this.data_tumb)),c.appendChild(d);var e=document.createElement("div");e.setAttribute("class","span-box"),b.appendChild(e);var f=document.createElement("span");f.setAttribute("data-lightbox-slide","prev"),f.setAttribute("class","lightbox-prev"),e.appendChild(f);var g=document.createElement("i");g.setAttribute("class","fa fa-angle-left"),g.setAttribute("aria-hidden","true"),f.appendChild(g);var h=document.createElement("span");h.setAttribute("data-lightbox-slide","next"),h.setAttribute("class","lightbox-next"),e.appendChild(h);var i=document.createElement("i");i.setAttribute("class","fa fa-angle-right"),i.setAttribute("aria-hidden","true"),h.appendChild(i);var j=document.createElement("span");j.setAttribute("data-lightbox-slide","close"),j.setAttribute("class","lightbox-close"),e.appendChild(j);var k=document.createElement("i");k.setAttribute("class","fa fa-times"),k.setAttribute("aria-hidden","true"),j.appendChild(k);var l=this;this.add_events(),d.onload=this.lightbox_size.bind(this,this.box_overlay),setTimeout(function(){l.box_overlay.classList.add("active")},100)}this.stop_scroll(1)},ImageBox.prototype.add_events=function(){function c(){b||(b=!0,a.show_slider(a,this),setTimeout(function(){b=!1},a.time))}this.lightbox_selector=this.box_overlay.querySelectorAll("[data-lightbox-slide]");for(var a=this,b=!1,d=0,e=this.lightbox_selector.length;d<e;d++)this.lightbox_selector[d].addEventListener("click",c);window.addEventListener("resize",this.lightbox_size.bind(this,this.box_overlay)),this.box_overlay.addEventListener("click",function(b){b=b||window.event;var c=b.target||b.srcElement;b.stopPropagation?b.stopPropagation():b.cancelBubble=!0,c==a.box_overlay&&a.close_overlay()})},ImageBox.prototype.stop_scroll=function(a){a?(document.onmousewheel=document.onwheel=function(){return!1},document.addEventListener("MozMousePixelScroll",function(){return!1},!1),document.onkeydown=function(a){return a.keyCode>=33&&a.keyCode<=40?!1:void 0}):(document.onmousewheel=document.onwheel=function(){return!0},document.addEventListener("MozMousePixelScroll",function(){return!0},!0),document.onkeydown=function(a){return a.keyCode>=33&&a.keyCode<=40?!0:void 0})},ImageBox.prototype.close_overlay=function(){this.box_overlay.classList.remove("active"),this.stop_scroll(0)},ImageBox.prototype.lightbox_size=function(a){var b=a.querySelector("img"),c=a.querySelector(".box_lightbox"),d=document.documentElement.clientWidth,e=document.documentElement.clientHeight,f=b.naturalWidth,g=b.naturalHeight,h=d/e;h>1.49?g>e?(c.style.height=e-40+"px",c.style.width=1.5*(e-40)+"px",c.style.margin="20px auto"):(c.style.height=g-40+"px",c.style.width=f-40+"px",c.style.margin="20px auto"):f>d?(c.style.height=(d-40)/1.5+"px",c.style.width=d-40+"px",c.style.margin="20px auto"):(c.style.height=g-40+"px",c.style.width=f-40+"px",c.style.margin="20px auto")},window.onload=gallery_box();